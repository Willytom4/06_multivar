---
title: "Assignment 5 - K-means"
author: "Oluwatomide Williams Ariyo"  
format:
  html:
    code-fold: true 
    embed-resources: true
    toc: true
    number-sections: true
    theme: cerulean
---

# Goal of this assignment  
The goal of this assignment is for you to **explore the k-means algorithm** learned in class.  

In specific, you will be asked to:  
  - Use a different number of k than what we did in class,  
  - Validate the results of the new model, and  
  - Compare your results with those found in class  

# Instructions  
You will first need to watch (and code along with) the following k-means video:

  - k-means lab: https://youtu.be/GFgMp5tYiMU?si=CI0E-2r-cYZLGVL1 (start from beginning of video, watch till the 01:10)  
  - The partial script for the video above is in our GitHub repository, 04-classcode, **02-24_multivar_kmeans_partial.qmd**. Move the script mentioned above into the `code` subfolder of your `06_multivar` project
  
**AFTER watching the video and developing the code in class**, then start working on this HW assignment (instructions below):
  - Move this script into the `code` subfolder of your `06_multivar` project  
  - On this script, fill your name under the `title` section of the YAML  
  - Go back to the class k-means script, choose a different number of k than what we did in class, and run it.    

```{r, reading data}
library(readr)
library(dplyr)
library(factoextra)
weather <- read_csv("../data/weather_monthsum.csv")

weather_norm <- weather %>% 
 dplyr:: select(-year, -site, -strength_gtex) %>%
  mutate(across(everything(), ~scale(.x)))

weather_norm
```

# Questions  
## 1. What number of k did you select? Why?  
```{r, k means}
mod_km3 <- kmeans(weather_norm,
                 centers = 3,
                 nstart = 10)
mod_km3

# After trying between 1 to 10 numbers of k (4 exclusive), I selected 3 numbers of k because it appears to be more logical and physically appealing than other numbers tried between 1 and 10.
```
## 2. How many observations are there in each cluster?  
```{r, number of observations}
weather %>%
  mutate(cluster = mod_km3$cluster) %>%
  group_by(cluster) %>%
  tally()

#There are 337, 108 and 253 observations in cluster 1, 2 and 3, respectively.
```

## 3. Using the `fviz_cluster()` function, import here the original plot with k=4 did in class, and the new plot with the number of k you selected for this exercise. How do they visually compare? Which one seems to be a better choice, and why?  

```{r, kmeans PCA plot}
library(gridExtra)

mod_km4 <- kmeans(weather_norm,
                 centers = 4,
                 nstart = 10)

plot_mod_km4 <- fviz_cluster(mod_km4,
             data = weather_norm,
             main = "k4 cluster")

plot_mod_km3 <- fviz_cluster(mod_km3,
             data = weather_norm,
             main = "k3 cluster")

grid.arrange(plot_mod_km3, plot_mod_km4, ncol = 2)

# (a) Visually, the k means with 4 clusters has four distinct populations while the k means with 3 clusters treated the 4th population as a subset or an outlier of one of the populations even though the populations are clearly distinct. 
# (b) The k means with 4 clusters seems to be the better choice
# (c) The one with the 4 clusters seems to be better based on the distinct populations observed on the plots.

```

Alternatively

```{r, alternative kmeans PCA plot}
both_plot <- grid.arrange(plot_mod_km3, plot_mod_km4, ncol = 2)
ggsave("../output/both_plot.png",
       width = 10,
       height = 20)  
```
# Submitting your work  
Once you have developed all the code and answers, make sure to Render this quarto file.  

**Notes on rendering**:  

- Make sure to render your work and inspect how the final html look like.  
- If it does not look professional for whatever reason, then fix the issue, re-render it, recheck.  
- Only send me your work once your html file looks professional.  
  - **DO NOT** delete the file's heading levels (# and ##). They set up the proper heading 1 and 2 levels, and I use them to guide my grading.  
  - If a given chunk is also outputting warnings or messages, inhibit this behavior by changing the chunk options `message` and `warning` to `FALSE` (I'll demo this in a moment).  
  
  - If, after rendered, 2 lines of text are connected and you wish to "break line" between them, add 2 extra spaces after the first one (I'lld demo this in a moment).  

After rendering, an .html file will be created on your `code` folder.  

Rename this file to `Assignment-05-kmeans-LASTNAME.html`.    

For ex., mine would be `Assignment-05-kmeans-Bastos.html`.

Submit your work by uploading the **html** file to **eLC Assignment #5 - K-means** by Monday March 2nd 11:59 pm.  
  




